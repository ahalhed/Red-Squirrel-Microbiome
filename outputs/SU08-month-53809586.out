Unloading StdEnv/2020

The following have been reloaded with a version change:
  1) gcccore/.9.3.0 => gcccore/.7.3.0     2) imkl/2020.1.217 => imkl/2018.3.222

[1] "Set up (working directory, theme, and packages)"
Loading required package: permute
Loading required package: lattice
This is vegan 2.5-6
Loading required package: MASS
Loading required package: NADA
Loading required package: survival

Attaching package: ‘NADA’

The following object is masked from ‘package:stats’:

    cor

Loading required package: truncnorm
Loading required package: ALDEx2
Loading required package: car
Loading required package: carData
── Attaching packages ─────────────────────────────────────── tidyverse 1.3.0 ──
✔ ggplot2 3.3.2     ✔ purrr   0.3.4
✔ tibble  3.0.1     ✔ dplyr   1.0.0
✔ tidyr   1.1.0     ✔ stringr 1.4.0
✔ readr   1.3.1     ✔ forcats 0.5.0
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
✖ dplyr::recode() masks car::recode()
✖ dplyr::select() masks MASS::select()
✖ purrr::some()   masks car::some()
[1] "Initiate functions for analysis"
[1] "Read in the Data"
[1] "Building phyloseq object"
[1] "Read in the metadata"
[1] "Aitchison transformation"
No. corrected values:  19086552 
[1] "Extract Core"
[1] "Subset the OTU table to find core and non-core OTUs"
[1] "Accessing the XY data by month"
[1] "Months in this Grid"
[1] 5
[1] "Computing Euclidean Distances"
[1] "Maximum Euclidean Distance by Month"
$`Month 5`
[1] 28.20018

Warning message:
`summarise_each_()` is deprecated as of dplyr 0.7.0.
Please use `across()` instead.
This warning is displayed once every 8 hours.
Call `lifecycle::last_warnings()` to see where this warning was generated. 
[1] "Build the community object (OTU table) for grid/year/month"
[1] "Extract metadata for grid/year/month"
[1] "Removing pobjects that are no longer needed"
[1] "Unweighted PCNM - for use with all OTU tables"
                              PCNM1       PCNM2       PCNM3       PCNM4
P3107.8404.F.1.SU.2008   0.27135641 -0.18101369 -0.07012213  0.22250494
P3181.8815.F.2.SU.2008   0.10756977  0.16150669  0.01082882 -0.49676661
P0137.10271.F.1.SU.2008  0.24951342  0.02122131 -0.06769587 -0.41109087
P1705.8579.F.4.SU.2008  -0.25765492 -0.20125280  0.14277625 -0.03160502
P0123.8404.F.1.SU.2008   0.27148558 -0.18114140 -0.07019332  0.22258359
P1277.8579.F.4.SU.2008  -0.19126298 -0.22238762  0.32666052 -0.02483345
P1786.10405.F.1.SU.2008 -0.22279516  0.01764951 -0.30754821  0.07301821
P1461.10747.F.1.SU.2008 -0.27719969 -0.10530517 -0.08903443  0.04715820
P1642.8398.F.4.SU.2008  -0.25322271 -0.04262434 -0.21351013  0.06470338
P0054.10133.F.3.SU.2008  0.31082110 -0.17673338 -0.09053869  0.08886634
P0064.8633.F.1.SU.2008  -0.15111065 -0.21032434  0.39059489 -0.04664591
P1791.8513.F.6.SU.2008   0.06692147  0.41455143  0.22767292  0.18542393
P1767.8513.F.6.SU.2008   0.06692147  0.41455143  0.22767292  0.18542393
P1424.10160.F.3.SU.2008 -0.21206325  0.06341098 -0.33120196 -0.09506182
P3066.8644.F.2.SU.2008   0.07588880  0.17810852 -0.08352943 -0.52773654
P1427.10133.F.3.SU.2008  0.31082110 -0.17673338 -0.09053869  0.08886634
P1631.8593.F.2.SU.2008   0.03913599  0.46283511  0.13319871  0.23611778
P0143.10747.F.1.SU.2008 -0.27719969 -0.10530517 -0.08903443  0.04715820
P1681.10362.F.1.SU.2008 -0.17434815  0.19745968 -0.30585911  0.16030879
P1254.10657.F.1.SU.2008 -0.06439901 -0.15173998  0.43994006 -0.07725974
P1520.10133.F.3.SU.2008  0.31082110 -0.17673338 -0.09053869  0.08886634
                              PCNM5       PCNM6       PCNM7       PCNM8
P3107.8404.F.1.SU.2008   0.25630061  0.17600829 -0.26420440  0.12438037
P3181.8815.F.2.SU.2008  -0.07069171  0.10096110 -0.23672292  0.27002468
P0137.10271.F.1.SU.2008 -0.37842659 -0.22415629  0.26682287 -0.11486018
P1705.8579.F.4.SU.2008   0.27838480 -0.21052903  0.25187181 -0.06035989
P0123.8404.F.1.SU.2008   0.25602282  0.17571665 -0.26375441  0.12403943
P1277.8579.F.4.SU.2008  -0.20315799 -0.10702398 -0.17189873  0.42498907
P1786.10405.F.1.SU.2008  0.12583395 -0.11799952  0.27998912 -0.11414637
P1461.10747.F.1.SU.2008 -0.18917364 -0.06440656 -0.26202864 -0.18437939
P1642.8398.F.4.SU.2008  -0.05733124 -0.24809973  0.04693793  0.56174672
P0054.10133.F.3.SU.2008 -0.10959540 -0.09360580  0.12136872 -0.07704075
P0064.8633.F.1.SU.2008  -0.14172646  0.18529940 -0.21258689 -0.46545155
P1791.8513.F.6.SU.2008   0.11448782 -0.31657058 -0.07371587 -0.05853586
P1767.8513.F.6.SU.2008   0.11448782 -0.31657058 -0.07371587 -0.05853586
P1424.10160.F.3.SU.2008  0.40084361  0.03051093  0.04028515 -0.19434255
P3066.8644.F.2.SU.2008   0.30053488  0.13501225 -0.18013044 -0.05042792
P1427.10133.F.3.SU.2008 -0.10959540 -0.09360580  0.12136872 -0.07704075
P1631.8593.F.2.SU.2008  -0.19496554  0.31095399  0.11683502  0.03218475
P0143.10747.F.1.SU.2008 -0.18917364 -0.06440656 -0.26202864 -0.18437939
P1681.10362.F.1.SU.2008 -0.30690643  0.49454855  0.12515960  0.04778822
P1254.10657.F.1.SU.2008  0.21344313  0.34156906  0.50877915  0.13138796
P1520.10133.F.3.SU.2008 -0.10959540 -0.09360580  0.12136872 -0.07704075
                              PCNM9        PCNM10
P3107.8404.F.1.SU.2008   0.10452578  7.071163e-01
P3181.8815.F.2.SU.2008   0.56254533 -6.381405e-04
P0137.10271.F.1.SU.2008 -0.06462771  6.463210e-04
P1705.8579.F.4.SU.2008   0.12501246 -3.141893e-06
P0123.8404.F.1.SU.2008   0.10398298 -7.070967e-01
P1277.8579.F.4.SU.2008  -0.26296717  9.909433e-08
P1786.10405.F.1.SU.2008  0.51780986  1.519761e-05
P1461.10747.F.1.SU.2008  0.01095856  2.899309e-08
P1642.8398.F.4.SU.2008  -0.13171371  2.262099e-08
P0054.10133.F.3.SU.2008 -0.07951403 -7.523507e-06
P0064.8633.F.1.SU.2008   0.06225872  9.849815e-08
P1791.8513.F.6.SU.2008   0.01638350  1.307126e-07
P1767.8513.F.6.SU.2008   0.01638350  1.307126e-07
P1424.10160.F.3.SU.2008 -0.35518381 -1.509795e-05
P3066.8644.F.2.SU.2008  -0.35585190  2.304893e-08
P1427.10133.F.3.SU.2008 -0.07951403 -7.523507e-06
P1631.8593.F.2.SU.2008  -0.09659125 -3.041916e-06
P0143.10747.F.1.SU.2008  0.01095856  2.899309e-08
P1681.10362.F.1.SU.2008 -0.03831079  1.516393e-07
P1254.10657.F.1.SU.2008  0.01296917  2.367145e-07
P1520.10133.F.3.SU.2008 -0.07951403 -7.523507e-06
[1] "Acessing PCNM scores"
[1] "Analysis for Core OTUs"
[1] "Variance partitioning - Core OTUs"
Warning messages:
1: collinearity detected in X2: mm = 16, m = 15 
2: collinearity detected in cbind(X1,X2): mm = 26, m = 20 
$`Month 5`

Partition of variance in RDA 

Call: (function (Y, X, ..., data, chisquare = FALSE, transfo, scale =
FALSE, add = FALSE, sqrt.dist = FALSE, permutations = 1000) { if
(missing(data)) data <- parent.frame() X <- list(X, ...)  if
((length(X) < 2 || length(X) > 4)) stop("needs two to four explanatory
tables") if (inherits(Y, "dist")) { inert <- attr(Y, "method") inert <-
paste(paste0(toupper(substring(inert, 1, 1)), substring(inert, 2)),
"distance") if (sqrt.dist) Y <- sqrt(Y) else inert <- paste("squared",
inert) if (is.logical(add) && isTRUE(add)) add <- "lingoes" if
(is.character(add)) { add <- match.arg(add, c("lingoes", "cailliez"))
if (add == "lingoes") { ac <- addLingoes(as.matrix(Y)) Y <- sqrt(Y^2 +
2 * ac) } else if (add == "cailliez") { ac <- addCailliez(as.matrix(Y))
Y <- Y + ac } if (ac > sqrt(.Machine$double.eps)) inert <-
paste(paste0(toupper(substring(add, 1, 1)), substring(add, 2)),
"adjusted", inert) } RDA <- "dbRDA" if (!missing(transfo) ||
!missing(scale)) message("arguments 'transfo' and 'scale' are ignored
with distances") } else if (chisquare) { inert = "Chi-square" RDA =
"CCA" permutations = getPermuteMatrix(permutations, nrow(Y)) } else {
inert <- "variance" RDA <- "RDA" if (!missing(transfo)) { Y <-
decostand(Y, transfo) transfo <- attr(Y, "decostand") } if
(!missing(transfo) && (is.null(dim(Y)) || ncol(Y) == 1))
warning("transformations are probably meaningless with a single
variable") if (scale && !missing(transfo)) warning("Y should not be
both transformed and scaled (standardized)") Y <- scale(Y, center =
TRUE, scale = scale) } Sets <- list() for (i in seq_along(X)) { if
(is.data.frame(X[[i]]) || is.factor(X[[i]])) { mf <-
as.data.frame(X[[i]]) mf <- model.matrix(~., mf) Sets[[i]] <- mf[, -1,
drop = FALSE] } else if (inherits(X[[i]], "formula")) { mf <-
model.frame(X[[i]], data, na.action = na.fail, drop.unused.levels =
TRUE) trms <- attr(mf, "terms") Sets[[i]] <- model.matrix(trms, mf) if
(any(colnames(Sets[[i]]) == "(Intercept)")) { xint <-
which(colnames(Sets[[i]]) == "(Intercept)") Sets[[i]] <- (Sets[[i]])[,
-xint, drop = FALSE] } } else Sets[[i]] <- as.matrix(X[[i]]) Sets[[i]]
<- scale(Sets[[i]], center = TRUE, scale = TRUE) } out <- list()
out$part <- switch(length(Sets), NULL, varpart2(Y, Sets[[1]],
Sets[[2]], chisquare, permutations), varpart3(Y, Sets[[1]], Sets[[2]],
Sets[[3]], chisquare, permutations), varpart4(Y, Sets[[1]], Sets[[2]],
Sets[[3]], Sets[[4]], chisquare, permutations)) if (inherits(Y,
"dist")) { out$part$ordination <- "dbrda" } else { if (chisquare)
out$part$ordination <- "cca" else { out$part$ordination <- "rda" } } if
(RDA == "RDA") { out$scale <- scale if (!missing(transfo)) out$transfo
<- transfo } else { if (scale || !missing(transfo)) message("arguments
'scale' and 'transfo' ignored: valid only in RDA") } out$inert <- inert
out$RDA <- RDA out$call <- match.call() mx <- rep(" ", length(X)) for
(i in seq_along(X)) mx[i] <- deparse(out$call[[i + 2]], width.cutoff =
500) out$tables <- mx class(out) <- c("varpart", class(out)) out })(Y =
dots[[1L]][[1L]], X = dots[[2L]][[1L]], ~., data = dots[[3L]][[1L]])

Explanatory tables:
X1:  dots[[2L]][[1L]]
X2:  ~. 

No. of explanatory tables: 2 
Total variation (SS): 585.03 
            Variance: 29.251 
No. of observations: 21 

Partition table:
                     Df R.squared Adj.R.squared Testable
[a+b] = X1           10   0.48162      -0.03676     TRUE
[b+c] = X2           15   0.81793       0.27172     TRUE
[a+b+c] = X1+X2      20   1.00000                   TRUE
Individual fractions                                    
[a] = X1|X2           5                             TRUE
[b]                   0                            FALSE
[c] = X2|X1          10                             TRUE
[d] = Residuals                                    FALSE
---
Use function ‘rda’ to test significance of fractions of interest

Warning message:
collinearity detected: redundant variable(s)  between tables X1, X2
results are probably incorrect: remove redundant variable(s) and repeat the analysis 
[1] "Testing with RDA (full model) - core OTUS"
$`Month 5`
Call: rda(formula = x ~ Age + Squirrel.ID + CollectionDate + BirthYear,
data = data)

              Inertia Proportion Rank
Total         29.2514     1.0000     
Constrained   23.9256     0.8179   12
Unconstrained  5.3258     0.1821    5
Inertia is variance 
Some constraints were aliased because they were collinear (redundant)

Eigenvalues for constrained axes:
 RDA1  RDA2  RDA3  RDA4  RDA5  RDA6  RDA7  RDA8  RDA9 RDA10 RDA11 RDA12 
8.745 4.979 2.711 2.289 1.430 1.108 0.986 0.704 0.445 0.315 0.129 0.085 

Eigenvalues for unconstrained axes:
   PC1    PC2    PC3    PC4    PC5 
1.8144 1.4987 1.0968 0.7052 0.2107 


$`Month 5`
Permutation test for rda under reduced model
Permutation: free
Number of permutations: 999

Model: rda(formula = x ~ Age + Squirrel.ID + CollectionDate + BirthYear, data = data)
         Df Variance      F Pr(>F)  
Model    15  23.9256 1.4975  0.081 .
Residual  5   5.3258                
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

$`Month 5`
$`Month 5`$r.squared
[1] 0.817931

$`Month 5`$adj.r.squared
[1] 0.271724


[1] "Testing with partial RDA (fraction [a]) - core OTUS"
$`Month 5`
Call: rda(formula = x ~ Age + Squirrel.ID + CollectionDate + BirthYear
+ Condition(scores(y)), data = data)

              Inertia Proportion Rank
Total         29.2514     1.0000     
Conditional   14.0881     0.4816   10
Constrained   15.1633     0.5184   10
Unconstrained  0.0000     0.0000    0
Inertia is variance 
Some constraints were aliased because they were collinear (redundant)

Eigenvalues for constrained axes:
 RDA1  RDA2  RDA3  RDA4  RDA5  RDA6  RDA7  RDA8  RDA9 RDA10 
7.253 2.775 1.782 1.338 0.696 0.625 0.487 0.128 0.070 0.009 


$`Month 5`
No residual component

Model: rda(formula = x ~ Age + Squirrel.ID + CollectionDate + BirthYear + Condition(scores(y)), data = data)
         Df Variance F Pr(>F)
Model    10   15.163         
Residual  0    0.000         

$`Month 5`
$`Month 5`$r.squared
[1] 0.5183785

$`Month 5`$adj.r.squared
[1] NA


[1] "Spatial variables - core OTU"
Step: R2.adj= 0 
Call: x ~ 1 
 
                 R2.adjusted
+ PCNM4          0.030727482
+ PCNM7          0.011371570
+ PCNM9          0.010082958
<none>           0.000000000
+ PCNM5         -0.001660427
+ PCNM2         -0.005205425
+ PCNM8         -0.008662244
+ PCNM6         -0.011634891
+ PCNM3         -0.013475700
+ PCNM10        -0.014533676
+ PCNM1         -0.016355401
<All variables> -0.036756934

$`Month 5`
Call: rda(formula = x ~ 1, data = data)

              Inertia Rank
Total           29.25     
Unconstrained   29.25   12
Inertia is variance 

Eigenvalues for unconstrained axes:
  PC1   PC2   PC3   PC4   PC5   PC6   PC7   PC8   PC9  PC10  PC11  PC12 
9.677 5.368 3.435 2.754 2.134 1.651 1.395 0.921 0.772 0.509 0.426 0.211 


[1] "Summary of spatial selection process - core OTU"
$`Month 5`
NULL

[1] "ANOVA on full spatial selection - core OTU"
$`Month 5`
No constrained component

Model: rda(formula = x ~ 1, data = data)
         Df Variance  F Pr(>F)
Model     0    0.000  0       
Residual 20   29.251          

[1] "Partition Bray-Curtis dissimilarities - core OTUs"
Warning message:
In FUN(X[[i]], ...) :
  results may be meaningless because data have negative entries in method “bray”
Warning messages:
1: collinearity detected in X1: mm = 16, m = 15 
2: collinearity detected in cbind(X1,X2): mm = 26, m = 20 
$`Month 5`

Partition of squared Bray distance in dbRDA 

Call: varpart(Y = x, X = ~., y, data = z)

Explanatory tables:
X1:  ~.
X2:  y 

No. of explanatory tables: 2 
Total variation (SS): 2.245 
No. of observations: 21 

Partition table:
                     Df R.squared Adj.R.squared Testable
[a+b] = X1           15   0.87533       0.50130     TRUE
[b+c] = X2           10   0.47316      -0.05368     TRUE
[a+b+c] = X1+X2      20   1.00000                   TRUE
Individual fractions                                    
[a] = X1|X2          10                             TRUE
[b]                   0                            FALSE
[c] = X2|X1           5                             TRUE
[d] = Residuals                                    FALSE
---
Use function ‘dbrda’ to test significance of fractions of interest

Warning message:
collinearity detected: redundant variable(s)  between tables X1, X2
results are probably incorrect: remove redundant variable(s) and repeat the analysis 
Warning message:
In rm(abFrac, aFrac, abFrac0, pcnm_df, bcFrac, bcFrac0, step.space) :
  object 'abFrac0' not found
[1] "Analysis for non-core OTUs"
[1] "Variance partitioning - non-core OTUs"
Warning messages:
1: collinearity detected in X2: mm = 16, m = 15 
2: collinearity detected in cbind(X1,X2): mm = 26, m = 20 
$`Month 5`

Partition of variance in RDA 

Call: (function (Y, X, ..., data, chisquare = FALSE, transfo, scale =
FALSE, add = FALSE, sqrt.dist = FALSE, permutations = 1000) { if
(missing(data)) data <- parent.frame() X <- list(X, ...)  if
((length(X) < 2 || length(X) > 4)) stop("needs two to four explanatory
tables") if (inherits(Y, "dist")) { inert <- attr(Y, "method") inert <-
paste(paste0(toupper(substring(inert, 1, 1)), substring(inert, 2)),
"distance") if (sqrt.dist) Y <- sqrt(Y) else inert <- paste("squared",
inert) if (is.logical(add) && isTRUE(add)) add <- "lingoes" if
(is.character(add)) { add <- match.arg(add, c("lingoes", "cailliez"))
if (add == "lingoes") { ac <- addLingoes(as.matrix(Y)) Y <- sqrt(Y^2 +
2 * ac) } else if (add == "cailliez") { ac <- addCailliez(as.matrix(Y))
Y <- Y + ac } if (ac > sqrt(.Machine$double.eps)) inert <-
paste(paste0(toupper(substring(add, 1, 1)), substring(add, 2)),
"adjusted", inert) } RDA <- "dbRDA" if (!missing(transfo) ||
!missing(scale)) message("arguments 'transfo' and 'scale' are ignored
with distances") } else if (chisquare) { inert = "Chi-square" RDA =
"CCA" permutations = getPermuteMatrix(permutations, nrow(Y)) } else {
inert <- "variance" RDA <- "RDA" if (!missing(transfo)) { Y <-
decostand(Y, transfo) transfo <- attr(Y, "decostand") } if
(!missing(transfo) && (is.null(dim(Y)) || ncol(Y) == 1))
warning("transformations are probably meaningless with a single
variable") if (scale && !missing(transfo)) warning("Y should not be
both transformed and scaled (standardized)") Y <- scale(Y, center =
TRUE, scale = scale) } Sets <- list() for (i in seq_along(X)) { if
(is.data.frame(X[[i]]) || is.factor(X[[i]])) { mf <-
as.data.frame(X[[i]]) mf <- model.matrix(~., mf) Sets[[i]] <- mf[, -1,
drop = FALSE] } else if (inherits(X[[i]], "formula")) { mf <-
model.frame(X[[i]], data, na.action = na.fail, drop.unused.levels =
TRUE) trms <- attr(mf, "terms") Sets[[i]] <- model.matrix(trms, mf) if
(any(colnames(Sets[[i]]) == "(Intercept)")) { xint <-
which(colnames(Sets[[i]]) == "(Intercept)") Sets[[i]] <- (Sets[[i]])[,
-xint, drop = FALSE] } } else Sets[[i]] <- as.matrix(X[[i]]) Sets[[i]]
<- scale(Sets[[i]], center = TRUE, scale = TRUE) } out <- list()
out$part <- switch(length(Sets), NULL, varpart2(Y, Sets[[1]],
Sets[[2]], chisquare, permutations), varpart3(Y, Sets[[1]], Sets[[2]],
Sets[[3]], chisquare, permutations), varpart4(Y, Sets[[1]], Sets[[2]],
Sets[[3]], Sets[[4]], chisquare, permutations)) if (inherits(Y,
"dist")) { out$part$ordination <- "dbrda" } else { if (chisquare)
out$part$ordination <- "cca" else { out$part$ordination <- "rda" } } if
(RDA == "RDA") { out$scale <- scale if (!missing(transfo)) out$transfo
<- transfo } else { if (scale || !missing(transfo)) message("arguments
'scale' and 'transfo' ignored: valid only in RDA") } out$inert <- inert
out$RDA <- RDA out$call <- match.call() mx <- rep(" ", length(X)) for
(i in seq_along(X)) mx[i] <- deparse(out$call[[i + 2]], width.cutoff =
500) out$tables <- mx class(out) <- c("varpart", class(out)) out })(Y =
dots[[1L]][[1L]], X = dots[[2L]][[1L]], ~., data = dots[[3L]][[1L]])

Explanatory tables:
X1:  dots[[2L]][[1L]]
X2:  ~. 

No. of explanatory tables: 2 
Total variation (SS): 88953 
            Variance: 4447.7 
No. of observations: 21 

Partition table:
                     Df R.squared Adj.R.squared Testable
[a+b] = X1           10   0.52302       0.04603     TRUE
[b+c] = X2           15   0.76865       0.07461     TRUE
[a+b+c] = X1+X2      20   1.00000                   TRUE
Individual fractions                                    
[a] = X1|X2           5                             TRUE
[b]                   0                            FALSE
[c] = X2|X1          10                             TRUE
[d] = Residuals                                    FALSE
---
Use function ‘rda’ to test significance of fractions of interest

Warning message:
collinearity detected: redundant variable(s)  between tables X1, X2
results are probably incorrect: remove redundant variable(s) and repeat the analysis 
[1] "Testing with RDA (full model) - non-core OTUS"
$`Month 5`
Call: rda(formula = x ~ Age + Squirrel.ID + CollectionDate + BirthYear,
data = data)

                Inertia Proportion Rank
Total         4447.6715     1.0000     
Constrained   3418.7150     0.7687   15
Unconstrained 1028.9565     0.2313    5
Inertia is variance 
Some constraints were aliased because they were collinear (redundant)

Eigenvalues for constrained axes:
 RDA1  RDA2  RDA3  RDA4  RDA5  RDA6  RDA7  RDA8  RDA9 RDA10 RDA11 RDA12 RDA13 
535.3 392.6 320.2 271.6 251.1 224.5 205.5 199.4 183.2 181.5 166.0 158.7 145.1 
RDA14 RDA15 
117.4  66.7 

Eigenvalues for unconstrained axes:
   PC1    PC2    PC3    PC4    PC5 
264.57 232.58 204.19 177.11 150.51 


$`Month 5`
Permutation test for rda under reduced model
Permutation: free
Number of permutations: 999

Model: rda(formula = x ~ Age + Squirrel.ID + CollectionDate + BirthYear, data = data)
         Df Variance      F Pr(>F)
Model    15   3418.7 1.1075  0.133
Residual  5   1029.0              

$`Month 5`
$`Month 5`$r.squared
[1] 0.7686528

$`Month 5`$adj.r.squared
[1] 0.07461105


[1] "Testing with partial RDA (fraction [a]) - non-core OTUS"
$`Month 5`
Call: rda(formula = x ~ Age + Squirrel.ID + CollectionDate + BirthYear
+ Condition(scores(y)), data = data)

               Inertia Proportion Rank
Total         4447.672      1.000     
Conditional   2326.201      0.523   10
Constrained   2121.471      0.477   10
Unconstrained    0.000      0.000    0
Inertia is variance 
Some constraints were aliased because they were collinear (redundant)

Eigenvalues for constrained axes:
 RDA1  RDA2  RDA3  RDA4  RDA5  RDA6  RDA7  RDA8  RDA9 RDA10 
424.3 257.3 238.6 221.5 210.9 194.7 171.7 160.0 144.0  98.5 


$`Month 5`
No residual component

Model: rda(formula = x ~ Age + Squirrel.ID + CollectionDate + BirthYear + Condition(scores(y)), data = data)
         Df Variance F Pr(>F)
Model    10   2121.5         
Residual  0      0.0         

$`Month 5`
$`Month 5`$r.squared
[1] 0.4769846

$`Month 5`$adj.r.squared
[1] NA


[1] "Spatial variables - non-core OTU"
Step: R2.adj= 0 
Call: x ~ 1 
 
                  R2.adjusted
<All variables>  0.0460307622
+ PCNM1          0.0186551862
+ PCNM2          0.0098875502
+ PCNM10         0.0089930920
+ PCNM6          0.0069357164
+ PCNM3          0.0055439092
+ PCNM4          0.0030369947
+ PCNM5          0.0005265758
<none>           0.0000000000
+ PCNM7         -0.0038954893
+ PCNM9         -0.0073736386
+ PCNM8         -0.0180831797

        Df    AIC      F Pr(>F)  
+ PCNM1  1 177.91 1.3802  0.036 *
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step: R2.adj= 0.01865519 
Call: x ~ PCNM1 
 
                 R2.adjusted
<All variables> 0.0460307622
+ PCNM2         0.0301284440
+ PCNM10        0.0291842936
+ PCNM6         0.0270126194
+ PCNM3         0.0255434896
+ PCNM4         0.0228973020
+ PCNM5         0.0202474154
<none>          0.0186551862
+ PCNM7         0.0155796800
+ PCNM9         0.0119083002
+ PCNM8         0.0006037846

        Df    AIC      F Pr(>F)
+ PCNM2  1 178.52 1.2248  0.134

$`Month 5`
Call: rda(formula = x ~ PCNM1, data = data)

                Inertia Proportion Rank
Total         4.448e+03  1.000e+00     
Constrained   3.012e+02  6.772e-02    1
Unconstrained 4.146e+03  9.323e-01   19
Inertia is variance 

Eigenvalues for constrained axes:
  RDA1 
301.21 

Eigenvalues for unconstrained axes:
  PC1   PC2   PC3   PC4   PC5   PC6   PC7   PC8 
556.4 392.3 311.2 295.0 266.3 244.6 224.3 220.2 
(Showing 8 of 19 unconstrained eigenvalues)


[1] "Summary of spatial selection process - non-core OTU"
$`Month 5`
                  R2.adj Df    AIC      F Pr(>F)  
+ PCNM1         0.018655  1 177.91 1.3802  0.036 *
<All variables> 0.046031                          
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

[1] "ANOVA on full spatial selection - non-core OTU"
$`Month 5`
Permutation test for rda under reduced model
Permutation: free
Number of permutations: 999

Model: rda(formula = x ~ PCNM1, data = data)
         Df Variance      F Pr(>F)  
Model     1    301.2 1.3802  0.032 *
Residual 19   4146.5                
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

[1] "Partition Bray-Curtis dissimilarities - non-core OTUs"
Warning message:
In FUN(X[[i]], ...) :
  results may be meaningless because data have negative entries in method “bray”
Warning messages:
1: collinearity detected in X1: mm = 16, m = 15 
2: collinearity detected in cbind(X1,X2): mm = 26, m = 20 
$`Month 5`

Partition of squared Bray distance in dbRDA 

Call: varpart(Y = x, X = ~., y, data = z)

Explanatory tables:
X1:  ~.
X2:  y 

No. of explanatory tables: 2 
Total variation (SS): 17.058 
No. of observations: 21 

Partition table:
                     Df R.squared Adj.R.squared Testable
[a+b] = X1           15   0.85398       0.41593     TRUE
[b+c] = X2           10   0.44971      -0.10058     TRUE
[a+b+c] = X1+X2      20   1.00000                   TRUE
Individual fractions                                    
[a] = X1|X2          10                             TRUE
[b]                   0                            FALSE
[c] = X2|X1           5                             TRUE
[d] = Residuals                                    FALSE
---
Use function ‘dbrda’ to test significance of fractions of interest

Warning message:
collinearity detected: redundant variable(s)  between tables X1, X2
results are probably incorrect: remove redundant variable(s) and repeat the analysis 
Warning message:
In rm(abFrac, aFrac, abFrac0, pcnm_df, bcFrac, bcFrac0, step.space) :
  object 'abFrac0' not found
[1] "Analysis for All OTUs"
[1] "Variance partitioning - All OTUs"
Warning messages:
1: collinearity detected in X2: mm = 16, m = 15 
2: collinearity detected in cbind(X1,X2): mm = 26, m = 20 
$`Month 5`

Partition of variance in RDA 

Call: (function (Y, X, ..., data, chisquare = FALSE, transfo, scale =
FALSE, add = FALSE, sqrt.dist = FALSE, permutations = 1000) { if
(missing(data)) data <- parent.frame() X <- list(X, ...)  if
((length(X) < 2 || length(X) > 4)) stop("needs two to four explanatory
tables") if (inherits(Y, "dist")) { inert <- attr(Y, "method") inert <-
paste(paste0(toupper(substring(inert, 1, 1)), substring(inert, 2)),
"distance") if (sqrt.dist) Y <- sqrt(Y) else inert <- paste("squared",
inert) if (is.logical(add) && isTRUE(add)) add <- "lingoes" if
(is.character(add)) { add <- match.arg(add, c("lingoes", "cailliez"))
if (add == "lingoes") { ac <- addLingoes(as.matrix(Y)) Y <- sqrt(Y^2 +
2 * ac) } else if (add == "cailliez") { ac <- addCailliez(as.matrix(Y))
Y <- Y + ac } if (ac > sqrt(.Machine$double.eps)) inert <-
paste(paste0(toupper(substring(add, 1, 1)), substring(add, 2)),
"adjusted", inert) } RDA <- "dbRDA" if (!missing(transfo) ||
!missing(scale)) message("arguments 'transfo' and 'scale' are ignored
with distances") } else if (chisquare) { inert = "Chi-square" RDA =
"CCA" permutations = getPermuteMatrix(permutations, nrow(Y)) } else {
inert <- "variance" RDA <- "RDA" if (!missing(transfo)) { Y <-
decostand(Y, transfo) transfo <- attr(Y, "decostand") } if
(!missing(transfo) && (is.null(dim(Y)) || ncol(Y) == 1))
warning("transformations are probably meaningless with a single
variable") if (scale && !missing(transfo)) warning("Y should not be
both transformed and scaled (standardized)") Y <- scale(Y, center =
TRUE, scale = scale) } Sets <- list() for (i in seq_along(X)) { if
(is.data.frame(X[[i]]) || is.factor(X[[i]])) { mf <-
as.data.frame(X[[i]]) mf <- model.matrix(~., mf) Sets[[i]] <- mf[, -1,
drop = FALSE] } else if (inherits(X[[i]], "formula")) { mf <-
model.frame(X[[i]], data, na.action = na.fail, drop.unused.levels =
TRUE) trms <- attr(mf, "terms") Sets[[i]] <- model.matrix(trms, mf) if
(any(colnames(Sets[[i]]) == "(Intercept)")) { xint <-
which(colnames(Sets[[i]]) == "(Intercept)") Sets[[i]] <- (Sets[[i]])[,
-xint, drop = FALSE] } } else Sets[[i]] <- as.matrix(X[[i]]) Sets[[i]]
<- scale(Sets[[i]], center = TRUE, scale = TRUE) } out <- list()
out$part <- switch(length(Sets), NULL, varpart2(Y, Sets[[1]],
Sets[[2]], chisquare, permutations), varpart3(Y, Sets[[1]], Sets[[2]],
Sets[[3]], chisquare, permutations), varpart4(Y, Sets[[1]], Sets[[2]],
Sets[[3]], Sets[[4]], chisquare, permutations)) if (inherits(Y,
"dist")) { out$part$ordination <- "dbrda" } else { if (chisquare)
out$part$ordination <- "cca" else { out$part$ordination <- "rda" } } if
(RDA == "RDA") { out$scale <- scale if (!missing(transfo)) out$transfo
<- transfo } else { if (scale || !missing(transfo)) message("arguments
'scale' and 'transfo' ignored: valid only in RDA") } out$inert <- inert
out$RDA <- RDA out$call <- match.call() mx <- rep(" ", length(X)) for
(i in seq_along(X)) mx[i] <- deparse(out$call[[i + 2]], width.cutoff =
500) out$tables <- mx class(out) <- c("varpart", class(out)) out })(Y =
dots[[1L]][[1L]], X = dots[[2L]][[1L]], ~., data = dots[[3L]][[1L]])

Explanatory tables:
X1:  dots[[2L]][[1L]]
X2:  ~. 

No. of explanatory tables: 2 
Total variation (SS): 89538 
            Variance: 4476.9 
No. of observations: 21 

Partition table:
                     Df R.squared Adj.R.squared Testable
[a+b] = X1           10   0.52274       0.04549     TRUE
[b+c] = X2           15   0.76897       0.07590     TRUE
[a+b+c] = X1+X2      20   1.00000                   TRUE
Individual fractions                                    
[a] = X1|X2           5                             TRUE
[b]                   0                            FALSE
[c] = X2|X1          10                             TRUE
[d] = Residuals                                    FALSE
---
Use function ‘rda’ to test significance of fractions of interest

Warning message:
collinearity detected: redundant variable(s)  between tables X1, X2
results are probably incorrect: remove redundant variable(s) and repeat the analysis 
[1] "Testing with RDA (full model) - all OTUS"
$`Month 5`
Call: rda(formula = x ~ Age + Squirrel.ID + CollectionDate + BirthYear,
data = data)

               Inertia Proportion Rank
Total         4476.923      1.000     
Constrained   3442.641      0.769   15
Unconstrained 1034.282      0.231    5
Inertia is variance 
Some constraints were aliased because they were collinear (redundant)

Eigenvalues for constrained axes:
 RDA1  RDA2  RDA3  RDA4  RDA5  RDA6  RDA7  RDA8  RDA9 RDA10 RDA11 RDA12 RDA13 
537.3 397.7 320.8 273.0 252.6 227.5 206.1 201.0 184.8 182.9 167.5 159.8 146.5 
RDA14 RDA15 
118.0  67.0 

Eigenvalues for unconstrained axes:
   PC1    PC2    PC3    PC4    PC5 
265.61 233.53 205.32 178.34 151.47 


$`Month 5`
Permutation test for rda under reduced model
Permutation: free
Number of permutations: 999

Model: rda(formula = x ~ Age + Squirrel.ID + CollectionDate + BirthYear, data = data)
         Df Variance      F Pr(>F)
Model    15   3442.6 1.1095  0.132
Residual  5   1034.3              

$`Month 5`
$`Month 5`$r.squared
[1] 0.7689747

$`Month 5`$adj.r.squared
[1] 0.07589895


[1] "Testing with partial RDA (fraction [a]) - all OTUS"
$`Month 5`
Call: rda(formula = x ~ Age + Squirrel.ID + CollectionDate + BirthYear
+ Condition(scores(y)), data = data)

                Inertia Proportion Rank
Total         4476.9229     1.0000     
Conditional   2340.2887     0.5227   10
Constrained   2136.6342     0.4773   10
Unconstrained    0.0000     0.0000    0
Inertia is variance 
Some constraints were aliased because they were collinear (redundant)

Eigenvalues for constrained axes:
 RDA1  RDA2  RDA3  RDA4  RDA5  RDA6  RDA7  RDA8  RDA9 RDA10 
426.3 259.8 240.3 224.3 212.9 196.1 172.6 160.8 144.9  98.7 


$`Month 5`
No residual component

Model: rda(formula = x ~ Age + Squirrel.ID + CollectionDate + BirthYear + Condition(scores(y)), data = data)
         Df Variance F Pr(>F)
Model    10   2136.6         
Residual  0      0.0         

$`Month 5`
$`Month 5`$r.squared
[1] 0.4772551

$`Month 5`$adj.r.squared
[1] NA


[1] "Forward selection for parsimonious model - all OTUs"
[1] "Spatial variables - all OTU"
Step: R2.adj= 0 
Call: x ~ 1 
 
                  R2.adjusted
<All variables>  0.0454898427
+ PCNM1          0.0184264334
+ PCNM2          0.0097889355
+ PCNM10         0.0088393724
+ PCNM6          0.0068143795
+ PCNM3          0.0054196386
+ PCNM4          0.0032179192
+ PCNM5          0.0005122863
<none>           0.0000000000
+ PCNM7         -0.0037957372
+ PCNM9         -0.0072595804
+ PCNM8         -0.0180216250

        Df    AIC      F Pr(>F)  
+ PCNM1  1 178.05 1.3754  0.026 *
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step: R2.adj= 0.01842643 
Call: x ~ PCNM1 
 
                 R2.adjusted
<All variables> 0.0454898427
+ PCNM2         0.0297828895
+ PCNM10        0.0287805728
+ PCNM6         0.0266430804
+ PCNM3         0.0251708538
+ PCNM4         0.0228468167
+ PCNM5         0.0199908708
<none>          0.0184264334
+ PCNM7         0.0154435127
+ PCNM9         0.0117872338
+ PCNM8         0.0004272978

        Df    AIC      F Pr(>F)
+ PCNM2  1 178.67 1.2224  0.112

$`Month 5`
Call: rda(formula = x ~ PCNM1, data = data)

                Inertia Proportion Rank
Total         4.477e+03  1.000e+00     
Constrained   3.022e+02  6.751e-02    1
Unconstrained 4.175e+03  9.325e-01   19
Inertia is variance 

Eigenvalues for constrained axes:
  RDA1 
302.22 

Eigenvalues for unconstrained axes:
  PC1   PC2   PC3   PC4   PC5   PC6   PC7   PC8 
559.1 395.9 312.3 296.2 267.5 249.1 226.5 221.7 
(Showing 8 of 19 unconstrained eigenvalues)


[1] "Summary of spatial selection process - all OTU"
$`Month 5`
                  R2.adj Df    AIC      F Pr(>F)  
+ PCNM1         0.018426  1 178.05 1.3754  0.026 *
<All variables> 0.045490                          
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

[1] "ANOVA on full spatial selection - all OTU"
$`Month 5`
Permutation test for rda under reduced model
Permutation: free
Number of permutations: 999

Model: rda(formula = x ~ PCNM1, data = data)
         Df Variance      F Pr(>F)  
Model     1    302.2 1.3754  0.046 *
Residual 19   4174.7                
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

[1] "Partition Bray-Curtis dissimilarities - all OTUs"
Warning message:
In FUN(X[[i]], ...) :
  results may be meaningless because data have negative entries in method “bray”
Warning messages:
1: collinearity detected in X1: mm = 16, m = 15 
2: collinearity detected in cbind(X1,X2): mm = 26, m = 20 
$`Month 5`

Partition of squared Bray distance in dbRDA 

Call: varpart(Y = x, X = ~., y, data = z)

Explanatory tables:
X1:  ~.
X2:  y 

No. of explanatory tables: 2 
Total variation (SS): 16.497 
No. of observations: 21 

Partition table:
                     Df R.squared Adj.R.squared Testable
[a+b] = X1           15   0.84664       0.38657     TRUE
[b+c] = X2           10   0.42935      -0.14131     TRUE
[a+b+c] = X1+X2      20   1.00000                   TRUE
Individual fractions                                    
[a] = X1|X2          10                             TRUE
[b]                   0                            FALSE
[c] = X2|X1           5                             TRUE
[d] = Residuals                                    FALSE
---
Use function ‘dbrda’ to test significance of fractions of interest

Warning message:
collinearity detected: redundant variable(s)  between tables X1, X2
results are probably incorrect: remove redundant variable(s) and repeat the analysis 
Warning message:
In rm(abFrac, aFrac, abFrac0, pcnm_df, bcFrac, bcFrac0, step.space) :
  object 'abFrac0' not found
