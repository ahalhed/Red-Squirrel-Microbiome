Unloading StdEnv/2020

The following have been reloaded with a version change:
  1) gcccore/.9.3.0 => gcccore/.7.3.0     2) imkl/2020.1.217 => imkl/2018.3.222

[1] "Set up (working directory, theme, and packages)"
Loading required package: permute
Loading required package: lattice
This is vegan 2.5-6
Loading required package: MASS
Loading required package: NADA
Loading required package: survival

Attaching package: ‘NADA’

The following object is masked from ‘package:stats’:

    cor

Loading required package: truncnorm
Loading required package: ALDEx2
Loading required package: car
Loading required package: carData
── Attaching packages ─────────────────────────────────────── tidyverse 1.3.0 ──
✔ ggplot2 3.3.2     ✔ purrr   0.3.4
✔ tibble  3.0.1     ✔ dplyr   1.0.0
✔ tidyr   1.1.0     ✔ stringr 1.4.0
✔ readr   1.3.1     ✔ forcats 0.5.0
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
✖ dplyr::recode() masks car::recode()
✖ dplyr::select() masks MASS::select()
✖ purrr::some()   masks car::some()
[1] "Initiate functions for analysis"
[1] "Read in the Data"
[1] "Building phyloseq object"
[1] "Read in the metadata"
[1] "Aitchison transformation"
No. corrected values:  19086552 
[1] "Extract Core"
[1] "Subset the OTU table to find core and non-core OTUs"
[1] "Accessing the XY data by month"
[1] "Months in this Grid"
[1] 5
[1] "Computing Euclidean Distances"
[1] "Maximum Euclidean Distance by Month"
$`Month 5`
[1] 25.6125

Warning message:
`summarise_each_()` is deprecated as of dplyr 0.7.0.
Please use `across()` instead.
This warning is displayed once every 8 hours.
Call `lifecycle::last_warnings()` to see where this warning was generated. 
[1] "Build the community object (OTU table) for grid/year/month"
[1] "Extract metadata for grid/year/month"
[1] "Removing pobjects that are no longer needed"
[1] "Unweighted PCNM - for use with all OTU tables"
                               PCNM1        PCNM2        PCNM3       PCNM4
P3011.10727.F.1.JO.2008 -0.050781213 -0.116748391  0.307527826  0.33528528
P1223.13663.F.4.JO.2008  0.314306567 -0.201480668 -0.041805605 -0.06888209
P2884.13663.F.4.JO.2008  0.241861442 -0.226095533 -0.125437394  0.01986591
P1496.8659.F.2.JO.2008  -0.198959986 -0.106319682 -0.305427243 -0.08173447
P1497.10156.F.3.JO.2008 -0.240375017 -0.060537361 -0.276829444 -0.08871290
P1430.8444.F.4.JO.2008   0.005736927 -0.123667282  0.124068218  0.37991242
P2930.10080.F.4.JO.2008  0.320948189 -0.087358911  0.012709193 -0.34887440
P1234.10636.F.3.JO.2008  0.173217076  0.046164236  0.066619671 -0.34896470
P1746.8746.F.3.JO.2008  -0.324408375 -0.043634027 -0.001767266 -0.18683376
P1551.13688.F.1.JO.2008 -0.165828059  0.016369504  0.402569686 -0.07592633
P1633.8598.F.1.JO.2008  -0.156267533  0.040002044  0.331576503 -0.17292465
P1509.13663.F.4.JO.2008  0.275748515 -0.203889133 -0.055616991  0.04047765
P1748.8659.F.2.JO.2008  -0.239771859 -0.060561165 -0.277063284 -0.08828262
P1604.10165.F.3.JO.2008  0.079162953  0.414628028 -0.096336332  0.12862489
P1751.10165.F.3.JO.2008  0.079162953  0.414628028 -0.096336332  0.12862489
P1859.8399.F.1.JO.2008  -0.065699085 -0.285771223 -0.213580879  0.23130538
P1605.10127.F.3.JO.2008 -0.212931806  0.105291688 -0.319730057 -0.01553651
P1727.13688.F.1.JO.2008 -0.165828059  0.016369504  0.402569686 -0.07592633
P1744.13684.F.2.JO.2008  0.205341699 -0.231694223  0.046743409  0.36763966
P1712.10417.F.1.JO.2008  0.114623902  0.391995977 -0.023736778  0.13228497
P1745.10226.F.3.JO.2008  0.114401608  0.390618668 -0.023372282  0.13166661
P1544.10636.F.3.JO.2008  0.227083018  0.005559572  0.057092123 -0.36980874
P1762.10223.F.3.JO.2008 -0.330743857 -0.093869652  0.105563572  0.02671987
                              PCNM5       PCNM6       PCNM7        PCNM8
P3011.10727.F.1.JO.2008 -0.26266611 -0.02768954  0.23961280  0.398029415
P1223.13663.F.4.JO.2008  0.15018771  0.33522517 -0.29165847  0.264175140
P2884.13663.F.4.JO.2008  0.33997027 -0.36040909  0.29574039  0.000224511
P1496.8659.F.2.JO.2008   0.06122473 -0.43527942  0.19800601  0.095699502
P1497.10156.F.3.JO.2008 -0.08821476 -0.02536568 -0.21018609  0.093131866
P1430.8444.F.4.JO.2008  -0.40347511 -0.06667187 -0.10044667 -0.418212851
P2930.10080.F.4.JO.2008 -0.04939725 -0.06975862  0.22297268 -0.072312500
P1234.10636.F.3.JO.2008 -0.43217070 -0.19802571  0.17250849 -0.249827021
P1746.8746.F.3.JO.2008   0.18641698  0.07820091 -0.16905719 -0.062020213
P1551.13688.F.1.JO.2008  0.15940770  0.01769944  0.12224660  0.222026585
P1633.8598.F.1.JO.2008   0.27631610  0.04986660 -0.21407801 -0.516956660
P1509.13663.F.4.JO.2008  0.31301409  0.12950210  0.02629582 -0.173512949
P1748.8659.F.2.JO.2008  -0.08843831 -0.02642565 -0.20951617  0.095093297
P1604.10165.F.3.JO.2008  0.04363037  0.20599213  0.20533449 -0.046621643
P1751.10165.F.3.JO.2008  0.04363037  0.20599213  0.20533449 -0.046621643
P1859.8399.F.1.JO.2008  -0.02180342  0.06977871 -0.10300084  0.032139297
P1605.10127.F.3.JO.2008 -0.04930654  0.43970274  0.35645898 -0.077776695
P1727.13688.F.1.JO.2008  0.15940770  0.01769944  0.12224660  0.222026585
P1744.13684.F.2.JO.2008  0.01143070  0.09221013 -0.09972569 -0.098464889
P1712.10417.F.1.JO.2008  0.06478074 -0.28557232 -0.28224910  0.093749972
P1745.10226.F.3.JO.2008  0.06445791 -0.28954853 -0.28714195  0.095244564
P1544.10636.F.3.JO.2008 -0.36565924  0.18201687 -0.23066421  0.236982459
P1762.10223.F.3.JO.2008 -0.11274394 -0.03913998  0.03096703 -0.086196130
                              PCNM9        PCNM10        PCNM11        PCNM12
P3011.10727.F.1.JO.2008 -0.12657732 -0.0240151023 -1.398993e-06  1.739702e-05
P1223.13663.F.4.JO.2008  0.24409978  0.1483463803  2.327674e-06  6.554034e-06
P2884.13663.F.4.JO.2008  0.27360308 -0.0095622001  1.043582e-04 -7.061118e-04
P1496.8659.F.2.JO.2008   0.36026166 -0.0246469086  7.619856e-06 -2.628537e-06
P1497.10156.F.3.JO.2008 -0.24381040 -0.0037030696 -2.768914e-03 -7.053466e-01
P1430.8444.F.4.JO.2008   0.14577762  0.2593966954  6.325889e-05 -7.191113e-04
P2930.10080.F.4.JO.2008 -0.23193369  0.3825042464  6.212650e-05 -7.629246e-04
P1234.10636.F.3.JO.2008 -0.18935992 -0.4472874549 -1.007711e-04 -1.100285e-04
P1746.8746.F.3.JO.2008  -0.01701975 -0.2895925021 -9.009327e-05 -5.344876e-03
P1551.13688.F.1.JO.2008 -0.06160801 -0.0495274373 -1.017240e-06 -1.425348e-06
P1633.8598.F.1.JO.2008   0.22101322  0.0019693704  5.316594e-05  4.386466e-03
P1509.13663.F.4.JO.2008 -0.52473398  0.0950603200 -1.069216e-04  7.166071e-04
P1748.8659.F.2.JO.2008  -0.24352668 -0.0059579309 -2.956244e-03  7.088249e-01
P1604.10165.F.3.JO.2008  0.07184632 -0.0002304651  1.196331e-04  3.522141e-04
P1751.10165.F.3.JO.2008  0.07184632 -0.0002304651  1.196331e-04  3.522141e-04
P1859.8399.F.1.JO.2008  -0.04327016 -0.0428663743 -1.867504e-04  9.394850e-04
P1605.10127.F.3.JO.2008  0.07030988 -0.0157865674  5.879087e-03  5.997898e-06
P1727.13688.F.1.JO.2008 -0.06160801 -0.0495274373 -1.017240e-06 -1.425348e-06
P1744.13684.F.2.JO.2008  0.07342373 -0.4921491523  8.196081e-05 -1.054449e-03
P1712.10417.F.1.JO.2008 -0.08113527  0.0451656409 -7.072299e-01 -8.804798e-04
P1745.10226.F.3.JO.2008 -0.08393375  0.0451781933  7.069475e-01 -6.798617e-04
P1544.10636.F.3.JO.2008  0.34793336  0.0119796178  9.250393e-07  7.684774e-06
P1762.10223.F.3.JO.2008  0.02840196  0.4654826029  1.343035e-06  4.091157e-07
[1] "Acessing PCNM scores"
[1] "Analysis for Core OTUs"
[1] "Variance partitioning - Core OTUs"
Warning messages:
1: collinearity detected in X2: mm = 14, m = 13 
2: collinearity detected in cbind(X1,X2): mm = 26, m = 22 
$`Month 5`

Partition of variance in RDA 

Call: (function (Y, X, ..., data, chisquare = FALSE, transfo, scale =
FALSE, add = FALSE, sqrt.dist = FALSE, permutations = 1000) { if
(missing(data)) data <- parent.frame() X <- list(X, ...)  if
((length(X) < 2 || length(X) > 4)) stop("needs two to four explanatory
tables") if (inherits(Y, "dist")) { inert <- attr(Y, "method") inert <-
paste(paste0(toupper(substring(inert, 1, 1)), substring(inert, 2)),
"distance") if (sqrt.dist) Y <- sqrt(Y) else inert <- paste("squared",
inert) if (is.logical(add) && isTRUE(add)) add <- "lingoes" if
(is.character(add)) { add <- match.arg(add, c("lingoes", "cailliez"))
if (add == "lingoes") { ac <- addLingoes(as.matrix(Y)) Y <- sqrt(Y^2 +
2 * ac) } else if (add == "cailliez") { ac <- addCailliez(as.matrix(Y))
Y <- Y + ac } if (ac > sqrt(.Machine$double.eps)) inert <-
paste(paste0(toupper(substring(add, 1, 1)), substring(add, 2)),
"adjusted", inert) } RDA <- "dbRDA" if (!missing(transfo) ||
!missing(scale)) message("arguments 'transfo' and 'scale' are ignored
with distances") } else if (chisquare) { inert = "Chi-square" RDA =
"CCA" permutations = getPermuteMatrix(permutations, nrow(Y)) } else {
inert <- "variance" RDA <- "RDA" if (!missing(transfo)) { Y <-
decostand(Y, transfo) transfo <- attr(Y, "decostand") } if
(!missing(transfo) && (is.null(dim(Y)) || ncol(Y) == 1))
warning("transformations are probably meaningless with a single
variable") if (scale && !missing(transfo)) warning("Y should not be
both transformed and scaled (standardized)") Y <- scale(Y, center =
TRUE, scale = scale) } Sets <- list() for (i in seq_along(X)) { if
(is.data.frame(X[[i]]) || is.factor(X[[i]])) { mf <-
as.data.frame(X[[i]]) mf <- model.matrix(~., mf) Sets[[i]] <- mf[, -1,
drop = FALSE] } else if (inherits(X[[i]], "formula")) { mf <-
model.frame(X[[i]], data, na.action = na.fail, drop.unused.levels =
TRUE) trms <- attr(mf, "terms") Sets[[i]] <- model.matrix(trms, mf) if
(any(colnames(Sets[[i]]) == "(Intercept)")) { xint <-
which(colnames(Sets[[i]]) == "(Intercept)") Sets[[i]] <- (Sets[[i]])[,
-xint, drop = FALSE] } } else Sets[[i]] <- as.matrix(X[[i]]) Sets[[i]]
<- scale(Sets[[i]], center = TRUE, scale = TRUE) } out <- list()
out$part <- switch(length(Sets), NULL, varpart2(Y, Sets[[1]],
Sets[[2]], chisquare, permutations), varpart3(Y, Sets[[1]], Sets[[2]],
Sets[[3]], chisquare, permutations), varpart4(Y, Sets[[1]], Sets[[2]],
Sets[[3]], Sets[[4]], chisquare, permutations)) if (inherits(Y,
"dist")) { out$part$ordination <- "dbrda" } else { if (chisquare)
out$part$ordination <- "cca" else { out$part$ordination <- "rda" } } if
(RDA == "RDA") { out$scale <- scale if (!missing(transfo)) out$transfo
<- transfo } else { if (scale || !missing(transfo)) message("arguments
'scale' and 'transfo' ignored: valid only in RDA") } out$inert <- inert
out$RDA <- RDA out$call <- match.call() mx <- rep(" ", length(X)) for
(i in seq_along(X)) mx[i] <- deparse(out$call[[i + 2]], width.cutoff =
500) out$tables <- mx class(out) <- c("varpart", class(out)) out })(Y =
dots[[1L]][[1L]], X = dots[[2L]][[1L]], ~., data = dots[[3L]][[1L]])

Explanatory tables:
X1:  dots[[2L]][[1L]]
X2:  ~. 

No. of explanatory tables: 2 
Total variation (SS): 484.23 
            Variance: 22.01 
No. of observations: 23 

Partition table:
                     Df R.squared Adj.R.squared Testable
[a+b] = X1           12   0.55641       0.02409     TRUE
[b+c] = X2           13   0.52030      -0.17260     TRUE
[a+b+c] = X1+X2      22   1.00000                   TRUE
Individual fractions                                    
[a] = X1|X2           9                             TRUE
[b]                   0                            FALSE
[c] = X2|X1          10                             TRUE
[d] = Residuals                                    FALSE
---
Use function ‘rda’ to test significance of fractions of interest

Warning message:
collinearity detected: redundant variable(s)  between tables X1, X2
results are probably incorrect: remove redundant variable(s) and repeat the analysis 
[1] "Testing with RDA (full model) - core OTUS"
$`Month 5`
Call: rda(formula = x ~ Age + Squirrel.ID + CollectionDate + BirthYear,
data = data)

              Inertia Proportion Rank
Total         22.0104     1.0000     
Constrained   11.4520     0.5203   12
Unconstrained 10.5584     0.4797    9
Inertia is variance 
Some constraints were aliased because they were collinear (redundant)

Eigenvalues for constrained axes:
  RDA1   RDA2   RDA3   RDA4   RDA5   RDA6   RDA7   RDA8   RDA9  RDA10  RDA11 
2.8004 2.0121 1.9074 1.7615 0.9807 0.7883 0.4865 0.3274 0.2259 0.1235 0.0314 
 RDA12 
0.0069 

Eigenvalues for unconstrained axes:
   PC1    PC2    PC3    PC4    PC5    PC6    PC7    PC8    PC9 
3.0926 2.6462 1.9308 0.9761 0.8621 0.4560 0.3164 0.2226 0.0557 


$`Month 5`
Permutation test for rda under reduced model
Permutation: free
Number of permutations: 999

Model: rda(formula = x ~ Age + Squirrel.ID + CollectionDate + BirthYear, data = data)
         Df Variance      F Pr(>F)
Model    13   11.452 0.7509  0.937
Residual  9   10.558              

$`Month 5`
$`Month 5`$r.squared
[1] 0.5203008

$`Month 5`$adj.r.squared
[1] -0.1725981


[1] "Testing with partial RDA (fraction [a]) - core OTUS"
$`Month 5`
Call: rda(formula = x ~ Age + Squirrel.ID + CollectionDate + BirthYear
+ Condition(scores(y)), data = data)

              Inertia Proportion Rank
Total         22.0104     1.0000     
Conditional   12.2467     0.5564   12
Constrained    9.7637     0.4436   10
Unconstrained  0.0000     0.0000    0
Inertia is variance 
Some constraints were aliased because they were collinear (redundant)

Eigenvalues for constrained axes:
  RDA1   RDA2   RDA3   RDA4   RDA5   RDA6   RDA7   RDA8   RDA9  RDA10 
2.9119 2.1110 1.5502 0.8979 0.8107 0.7070 0.4136 0.2301 0.0893 0.0421 


$`Month 5`
No residual component

Model: rda(formula = x ~ Age + Squirrel.ID + CollectionDate + BirthYear + Condition(scores(y)), data = data)
         Df Variance F Pr(>F)
Model    10   9.7637         
Residual  0   0.0000         

$`Month 5`
$`Month 5`$r.squared
[1] 0.4435932

$`Month 5`$adj.r.squared
[1] NA


[1] "Spatial variables - core OTU"
Step: R2.adj= 0 
Call: x ~ 1 
 
                 R2.adjusted
+ PCNM10         0.027168842
<All variables>  0.024094877
+ PCNM6          0.019148832
+ PCNM8          0.011314280
+ PCNM11         0.010160132
+ PCNM2          0.004191726
+ PCNM3          0.001329029
<none>           0.000000000
+ PCNM1         -0.003546959
+ PCNM9         -0.003942139
+ PCNM4         -0.009371305
+ PCNM5         -0.009504151
+ PCNM12        -0.014825893
+ PCNM7         -0.020648645

$`Month 5`
Call: rda(formula = x ~ 1, data = data)

              Inertia Rank
Total           22.01     
Unconstrained   22.01   12
Inertia is variance 

Eigenvalues for unconstrained axes:
  PC1   PC2   PC3   PC4   PC5   PC6   PC7   PC8   PC9  PC10  PC11  PC12 
4.801 4.433 3.302 2.431 1.884 1.528 1.256 0.920 0.727 0.368 0.269 0.090 


[1] "Summary of spatial selection process - core OTU"
$`Month 5`
NULL

[1] "ANOVA on full spatial selection - core OTU"
$`Month 5`
No constrained component

Model: rda(formula = x ~ 1, data = data)
         Df Variance  F Pr(>F)
Model     0     0.00  0       
Residual 22    22.01          

[1] "Partition Bray-Curtis dissimilarities - core OTUs"
Warning message:
In FUN(X[[i]], ...) :
  results may be meaningless because data have negative entries in method “bray”
Warning messages:
1: collinearity detected in X1: mm = 14, m = 13 
2: collinearity detected in cbind(X1,X2): mm = 26, m = 22 
$`Month 5`

Partition of squared Bray distance in dbRDA 

Call: varpart(Y = x, X = ~., y, data = z)

Explanatory tables:
X1:  ~.
X2:  y 

No. of explanatory tables: 2 
Total variation (SS): 1.0516 
No. of observations: 23 

Partition table:
                     Df R.squared Adj.R.squared Testable
[a+b] = X1           13   0.54768      -0.10568     TRUE
[b+c] = X2           12   0.56854       0.05079     TRUE
[a+b+c] = X1+X2      22   1.00000                   TRUE
Individual fractions                                    
[a] = X1|X2          10                             TRUE
[b]                   0                            FALSE
[c] = X2|X1           9                             TRUE
[d] = Residuals                                    FALSE
---
Use function ‘dbrda’ to test significance of fractions of interest

Warning message:
collinearity detected: redundant variable(s)  between tables X1, X2
results are probably incorrect: remove redundant variable(s) and repeat the analysis 
Warning message:
In rm(abFrac, aFrac, abFrac0, pcnm_df, bcFrac, bcFrac0, step.space) :
  object 'abFrac0' not found
[1] "Analysis for non-core OTUs"
[1] "Variance partitioning - non-core OTUs"
Warning messages:
1: collinearity detected in X2: mm = 14, m = 13 
2: collinearity detected in cbind(X1,X2): mm = 26, m = 22 
$`Month 5`

Partition of variance in RDA 

Call: (function (Y, X, ..., data, chisquare = FALSE, transfo, scale =
FALSE, add = FALSE, sqrt.dist = FALSE, permutations = 1000) { if
(missing(data)) data <- parent.frame() X <- list(X, ...)  if
((length(X) < 2 || length(X) > 4)) stop("needs two to four explanatory
tables") if (inherits(Y, "dist")) { inert <- attr(Y, "method") inert <-
paste(paste0(toupper(substring(inert, 1, 1)), substring(inert, 2)),
"distance") if (sqrt.dist) Y <- sqrt(Y) else inert <- paste("squared",
inert) if (is.logical(add) && isTRUE(add)) add <- "lingoes" if
(is.character(add)) { add <- match.arg(add, c("lingoes", "cailliez"))
if (add == "lingoes") { ac <- addLingoes(as.matrix(Y)) Y <- sqrt(Y^2 +
2 * ac) } else if (add == "cailliez") { ac <- addCailliez(as.matrix(Y))
Y <- Y + ac } if (ac > sqrt(.Machine$double.eps)) inert <-
paste(paste0(toupper(substring(add, 1, 1)), substring(add, 2)),
"adjusted", inert) } RDA <- "dbRDA" if (!missing(transfo) ||
!missing(scale)) message("arguments 'transfo' and 'scale' are ignored
with distances") } else if (chisquare) { inert = "Chi-square" RDA =
"CCA" permutations = getPermuteMatrix(permutations, nrow(Y)) } else {
inert <- "variance" RDA <- "RDA" if (!missing(transfo)) { Y <-
decostand(Y, transfo) transfo <- attr(Y, "decostand") } if
(!missing(transfo) && (is.null(dim(Y)) || ncol(Y) == 1))
warning("transformations are probably meaningless with a single
variable") if (scale && !missing(transfo)) warning("Y should not be
both transformed and scaled (standardized)") Y <- scale(Y, center =
TRUE, scale = scale) } Sets <- list() for (i in seq_along(X)) { if
(is.data.frame(X[[i]]) || is.factor(X[[i]])) { mf <-
as.data.frame(X[[i]]) mf <- model.matrix(~., mf) Sets[[i]] <- mf[, -1,
drop = FALSE] } else if (inherits(X[[i]], "formula")) { mf <-
model.frame(X[[i]], data, na.action = na.fail, drop.unused.levels =
TRUE) trms <- attr(mf, "terms") Sets[[i]] <- model.matrix(trms, mf) if
(any(colnames(Sets[[i]]) == "(Intercept)")) { xint <-
which(colnames(Sets[[i]]) == "(Intercept)") Sets[[i]] <- (Sets[[i]])[,
-xint, drop = FALSE] } } else Sets[[i]] <- as.matrix(X[[i]]) Sets[[i]]
<- scale(Sets[[i]], center = TRUE, scale = TRUE) } out <- list()
out$part <- switch(length(Sets), NULL, varpart2(Y, Sets[[1]],
Sets[[2]], chisquare, permutations), varpart3(Y, Sets[[1]], Sets[[2]],
Sets[[3]], chisquare, permutations), varpart4(Y, Sets[[1]], Sets[[2]],
Sets[[3]], Sets[[4]], chisquare, permutations)) if (inherits(Y,
"dist")) { out$part$ordination <- "dbrda" } else { if (chisquare)
out$part$ordination <- "cca" else { out$part$ordination <- "rda" } } if
(RDA == "RDA") { out$scale <- scale if (!missing(transfo)) out$transfo
<- transfo } else { if (scale || !missing(transfo)) message("arguments
'scale' and 'transfo' ignored: valid only in RDA") } out$inert <- inert
out$RDA <- RDA out$call <- match.call() mx <- rep(" ", length(X)) for
(i in seq_along(X)) mx[i] <- deparse(out$call[[i + 2]], width.cutoff =
500) out$tables <- mx class(out) <- c("varpart", class(out)) out })(Y =
dots[[1L]][[1L]], X = dots[[2L]][[1L]], ~., data = dots[[3L]][[1L]])

Explanatory tables:
X1:  dots[[2L]][[1L]]
X2:  ~. 

No. of explanatory tables: 2 
Total variation (SS): 99439 
            Variance: 4519.9 
No. of observations: 23 

Partition table:
                     Df R.squared Adj.R.squared Testable
[a+b] = X1           12   0.55659       0.02451     TRUE
[b+c] = X2           13   0.60398       0.03194     TRUE
[a+b+c] = X1+X2      22   1.00000                   TRUE
Individual fractions                                    
[a] = X1|X2           9                             TRUE
[b]                   0                            FALSE
[c] = X2|X1          10                             TRUE
[d] = Residuals                                    FALSE
---
Use function ‘rda’ to test significance of fractions of interest

Warning message:
collinearity detected: redundant variable(s)  between tables X1, X2
results are probably incorrect: remove redundant variable(s) and repeat the analysis 
[1] "Testing with RDA (full model) - non-core OTUS"
$`Month 5`
Call: rda(formula = x ~ Age + Squirrel.ID + CollectionDate + BirthYear,
data = data)

               Inertia Proportion Rank
Total         4519.946      1.000     
Constrained   2729.943      0.604   13
Unconstrained 1790.003      0.396    9
Inertia is variance 
Some constraints were aliased because they were collinear (redundant)

Eigenvalues for constrained axes:
 RDA1  RDA2  RDA3  RDA4  RDA5  RDA6  RDA7  RDA8  RDA9 RDA10 RDA11 RDA12 RDA13 
328.6 293.9 252.8 234.8 224.2 207.9 194.5 191.0 183.8 172.4 164.7 150.2 131.2 

Eigenvalues for unconstrained axes:
   PC1    PC2    PC3    PC4    PC5    PC6    PC7    PC8    PC9 
280.61 237.29 213.71 209.16 191.94 177.05 170.44 156.55 153.24 


$`Month 5`
Permutation test for rda under reduced model
Permutation: free
Number of permutations: 999

Model: rda(formula = x ~ Age + Squirrel.ID + CollectionDate + BirthYear, data = data)
         Df Variance      F Pr(>F)  
Model    13   2729.9 1.0558  0.084 .
Residual  9   1790.0                
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

$`Month 5`
$`Month 5`$r.squared
[1] 0.603977

$`Month 5`$adj.r.squared
[1] 0.03194383


[1] "Testing with partial RDA (fraction [a]) - non-core OTUS"
$`Month 5`
Call: rda(formula = x ~ Age + Squirrel.ID + CollectionDate + BirthYear
+ Condition(scores(y)), data = data)

                Inertia Proportion Rank
Total         4519.9460     1.0000     
Conditional   2515.7779     0.5566   12
Constrained   2004.1681     0.4434   10
Unconstrained    0.0000     0.0000    0
Inertia is variance 
Some constraints were aliased because they were collinear (redundant)

Eigenvalues for constrained axes:
  RDA1   RDA2   RDA3   RDA4   RDA5   RDA6   RDA7   RDA8   RDA9  RDA10 
286.25 278.10 229.82 218.45 193.69 184.14 173.69 161.61 147.07 131.34 


$`Month 5`
No residual component

Model: rda(formula = x ~ Age + Squirrel.ID + CollectionDate + BirthYear + Condition(scores(y)), data = data)
         Df Variance F Pr(>F)
Model    10   2004.2         
Residual  0      0.0         

$`Month 5`
$`Month 5`$r.squared
[1] 0.4434053

$`Month 5`$adj.r.squared
[1] NA


[1] "Spatial variables - non-core OTU"
Step: R2.adj= 0 
Call: x ~ 1 
 
                  R2.adjusted
<All variables>  0.0245082929
+ PCNM10         0.0107037562
+ PCNM3          0.0103668217
+ PCNM5          0.0093899554
+ PCNM2          0.0066677073
+ PCNM1          0.0032970852
+ PCNM8          0.0008387913
<none>           0.0000000000
+ PCNM4         -0.0007490217
+ PCNM6         -0.0007764037
+ PCNM12        -0.0034447106
+ PCNM7         -0.0039302711
+ PCNM9         -0.0099761295
+ PCNM11        -0.0107169647

         Df    AIC     F Pr(>F)  
+ PCNM10  1 195.23 1.238   0.02 *
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step: R2.adj= 0.01070376 
Call: x ~ PCNM10 
 
                  R2.adjusted
<All variables>  2.450829e-02
+ PCNM3          2.212411e-02
+ PCNM5          2.109840e-02
+ PCNM2          1.824004e-02
+ PCNM1          1.470088e-02
+ PCNM8          1.211967e-02
<none>           1.070376e-02
+ PCNM4          1.045247e-02
+ PCNM6          1.042372e-02
+ PCNM12         7.621998e-03
+ PCNM7          7.112159e-03
+ PCNM9          7.640081e-04
+ PCNM11        -1.386897e-05

        Df    AIC      F Pr(>F)  
+ PCNM3  1 195.84 1.2453  0.026 *
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step: R2.adj= 0.02212411 
Call: x ~ PCNM10 + PCNM3 
 
                R2.adjusted
+ PCNM5          0.03366691
+ PCNM2          0.03065810
+ PCNM1          0.02693268
<All variables>  0.02450829
+ PCNM8          0.02421562
+ PCNM4          0.02246067
+ PCNM6          0.02243040
<none>           0.02212411
+ PCNM12         0.01948122
+ PCNM7          0.01894455
+ PCNM9          0.01226229
+ PCNM11         0.01144347

$`Month 5`
Call: rda(formula = x ~ PCNM10 + PCNM3, data = data)

               Inertia Proportion Rank
Total         4519.946      1.000     
Constrained    501.813      0.111    2
Unconstrained 4018.133      0.889   20
Inertia is variance 

Eigenvalues for constrained axes:
  RDA1   RDA2 
272.13 229.68 

Eigenvalues for unconstrained axes:
  PC1   PC2   PC3   PC4   PC5   PC6   PC7   PC8 
351.0 334.6 286.0 245.9 239.3 231.0 210.6 205.4 
(Showing 8 of 20 unconstrained eigenvalues)


[1] "Summary of spatial selection process - non-core OTU"
$`Month 5`
                  R2.adj Df    AIC      F Pr(>F)  
+ PCNM10        0.010704  1 195.23 1.2380  0.020 *
+ PCNM3         0.022124  1 195.84 1.2453  0.026 *
<All variables> 0.024508                          
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

[1] "ANOVA on full spatial selection - non-core OTU"
$`Month 5`
Permutation test for rda under reduced model
Permutation: free
Number of permutations: 999

Model: rda(formula = x ~ PCNM10 + PCNM3, data = data)
         Df Variance      F Pr(>F)   
Model     2    501.8 1.2489  0.006 **
Residual 20   4018.1                 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

[1] "Partition Bray-Curtis dissimilarities - non-core OTUs"
Warning message:
In FUN(X[[i]], ...) :
  results may be meaningless because data have negative entries in method “bray”
Warning messages:
1: collinearity detected in X1: mm = 14, m = 13 
2: collinearity detected in cbind(X1,X2): mm = 26, m = 22 
$`Month 5`

Partition of squared Bray distance in dbRDA 

Call: varpart(Y = x, X = ~., y, data = z)

Explanatory tables:
X1:  ~.
X2:  y 

No. of explanatory tables: 2 
Total variation (SS): 3.5509 
No. of observations: 23 

Partition table:
                     Df R.squared Adj.R.squared Testable
[a+b] = X1           13   0.65562       0.15818     TRUE
[b+c] = X2           12   0.55382       0.01841     TRUE
[a+b+c] = X1+X2      22   1.00000                   TRUE
Individual fractions                                    
[a] = X1|X2          10                             TRUE
[b]                   0                            FALSE
[c] = X2|X1           9                             TRUE
[d] = Residuals                                    FALSE
---
Use function ‘dbrda’ to test significance of fractions of interest

Warning message:
collinearity detected: redundant variable(s)  between tables X1, X2
results are probably incorrect: remove redundant variable(s) and repeat the analysis 
Warning message:
In rm(abFrac, aFrac, abFrac0, pcnm_df, bcFrac, bcFrac0, step.space) :
  object 'abFrac0' not found
[1] "Analysis for All OTUs"
[1] "Variance partitioning - All OTUs"
Warning messages:
1: collinearity detected in X2: mm = 14, m = 13 
2: collinearity detected in cbind(X1,X2): mm = 26, m = 22 
$`Month 5`

Partition of variance in RDA 

Call: (function (Y, X, ..., data, chisquare = FALSE, transfo, scale =
FALSE, add = FALSE, sqrt.dist = FALSE, permutations = 1000) { if
(missing(data)) data <- parent.frame() X <- list(X, ...)  if
((length(X) < 2 || length(X) > 4)) stop("needs two to four explanatory
tables") if (inherits(Y, "dist")) { inert <- attr(Y, "method") inert <-
paste(paste0(toupper(substring(inert, 1, 1)), substring(inert, 2)),
"distance") if (sqrt.dist) Y <- sqrt(Y) else inert <- paste("squared",
inert) if (is.logical(add) && isTRUE(add)) add <- "lingoes" if
(is.character(add)) { add <- match.arg(add, c("lingoes", "cailliez"))
if (add == "lingoes") { ac <- addLingoes(as.matrix(Y)) Y <- sqrt(Y^2 +
2 * ac) } else if (add == "cailliez") { ac <- addCailliez(as.matrix(Y))
Y <- Y + ac } if (ac > sqrt(.Machine$double.eps)) inert <-
paste(paste0(toupper(substring(add, 1, 1)), substring(add, 2)),
"adjusted", inert) } RDA <- "dbRDA" if (!missing(transfo) ||
!missing(scale)) message("arguments 'transfo' and 'scale' are ignored
with distances") } else if (chisquare) { inert = "Chi-square" RDA =
"CCA" permutations = getPermuteMatrix(permutations, nrow(Y)) } else {
inert <- "variance" RDA <- "RDA" if (!missing(transfo)) { Y <-
decostand(Y, transfo) transfo <- attr(Y, "decostand") } if
(!missing(transfo) && (is.null(dim(Y)) || ncol(Y) == 1))
warning("transformations are probably meaningless with a single
variable") if (scale && !missing(transfo)) warning("Y should not be
both transformed and scaled (standardized)") Y <- scale(Y, center =
TRUE, scale = scale) } Sets <- list() for (i in seq_along(X)) { if
(is.data.frame(X[[i]]) || is.factor(X[[i]])) { mf <-
as.data.frame(X[[i]]) mf <- model.matrix(~., mf) Sets[[i]] <- mf[, -1,
drop = FALSE] } else if (inherits(X[[i]], "formula")) { mf <-
model.frame(X[[i]], data, na.action = na.fail, drop.unused.levels =
TRUE) trms <- attr(mf, "terms") Sets[[i]] <- model.matrix(trms, mf) if
(any(colnames(Sets[[i]]) == "(Intercept)")) { xint <-
which(colnames(Sets[[i]]) == "(Intercept)") Sets[[i]] <- (Sets[[i]])[,
-xint, drop = FALSE] } } else Sets[[i]] <- as.matrix(X[[i]]) Sets[[i]]
<- scale(Sets[[i]], center = TRUE, scale = TRUE) } out <- list()
out$part <- switch(length(Sets), NULL, varpart2(Y, Sets[[1]],
Sets[[2]], chisquare, permutations), varpart3(Y, Sets[[1]], Sets[[2]],
Sets[[3]], chisquare, permutations), varpart4(Y, Sets[[1]], Sets[[2]],
Sets[[3]], Sets[[4]], chisquare, permutations)) if (inherits(Y,
"dist")) { out$part$ordination <- "dbrda" } else { if (chisquare)
out$part$ordination <- "cca" else { out$part$ordination <- "rda" } } if
(RDA == "RDA") { out$scale <- scale if (!missing(transfo)) out$transfo
<- transfo } else { if (scale || !missing(transfo)) message("arguments
'scale' and 'transfo' ignored: valid only in RDA") } out$inert <- inert
out$RDA <- RDA out$call <- match.call() mx <- rep(" ", length(X)) for
(i in seq_along(X)) mx[i] <- deparse(out$call[[i + 2]], width.cutoff =
500) out$tables <- mx class(out) <- c("varpart", class(out)) out })(Y =
dots[[1L]][[1L]], X = dots[[2L]][[1L]], ~., data = dots[[3L]][[1L]])

Explanatory tables:
X1:  dots[[2L]][[1L]]
X2:  ~. 

No. of explanatory tables: 2 
Total variation (SS): 99923 
            Variance: 4542 
No. of observations: 23 

Partition table:
                     Df R.squared Adj.R.squared Testable
[a+b] = X1           12   0.55659       0.02451     TRUE
[b+c] = X2           13   0.60357       0.03095     TRUE
[a+b+c] = X1+X2      22   1.00000                   TRUE
Individual fractions                                    
[a] = X1|X2           9                             TRUE
[b]                   0                            FALSE
[c] = X2|X1          10                             TRUE
[d] = Residuals                                    FALSE
---
Use function ‘rda’ to test significance of fractions of interest

Warning message:
collinearity detected: redundant variable(s)  between tables X1, X2
results are probably incorrect: remove redundant variable(s) and repeat the analysis 
[1] "Testing with RDA (full model) - all OTUS"
$`Month 5`
Call: rda(formula = x ~ Age + Squirrel.ID + CollectionDate + BirthYear,
data = data)

                Inertia Proportion Rank
Total         4541.9563     1.0000     
Constrained   2741.3955     0.6036   13
Unconstrained 1800.5608     0.3964    9
Inertia is variance 
Some constraints were aliased because they were collinear (redundant)

Eigenvalues for constrained axes:
 RDA1  RDA2  RDA3  RDA4  RDA5  RDA6  RDA7  RDA8  RDA9 RDA10 RDA11 RDA12 RDA13 
329.6 294.4 253.4 235.6 225.0 209.3 195.2 191.6 184.9 173.5 165.8 150.8 132.4 

Eigenvalues for unconstrained axes:
   PC1    PC2    PC3    PC4    PC5    PC6    PC7    PC8    PC9 
281.12 238.50 215.03 210.68 193.52 177.52 172.40 157.67 154.13 


$`Month 5`
Permutation test for rda under reduced model
Permutation: free
Number of permutations: 999

Model: rda(formula = x ~ Age + Squirrel.ID + CollectionDate + BirthYear, data = data)
         Df Variance      F Pr(>F)
Model    13   2741.4 1.0541  0.106
Residual  9   1800.6              

$`Month 5`
$`Month 5`$r.squared
[1] 0.6035715

$`Month 5`$adj.r.squared
[1] 0.03095262


[1] "Testing with partial RDA (fraction [a]) - all OTUS"
$`Month 5`
Call: rda(formula = x ~ Age + Squirrel.ID + CollectionDate + BirthYear
+ Condition(scores(y)), data = data)

                Inertia Proportion Rank
Total         4541.9563     1.0000     
Conditional   2528.0246     0.5566   12
Constrained   2013.9318     0.4434   10
Unconstrained    0.0000     0.0000    0
Inertia is variance 
Some constraints were aliased because they were collinear (redundant)

Eigenvalues for constrained axes:
  RDA1   RDA2   RDA3   RDA4   RDA5   RDA6   RDA7   RDA8   RDA9  RDA10 
287.38 278.88 230.76 219.20 194.71 184.60 174.66 162.74 148.37 132.62 


$`Month 5`
No residual component

Model: rda(formula = x ~ Age + Squirrel.ID + CollectionDate + BirthYear + Condition(scores(y)), data = data)
         Df Variance F Pr(>F)
Model    10   2013.9         
Residual  0      0.0         

$`Month 5`
$`Month 5`$r.squared
[1] 0.4434062

$`Month 5`$adj.r.squared
[1] NA


[1] "Forward selection for parsimonious model - all OTUs"
[1] "Spatial variables - all OTU"
Step: R2.adj= 0 
Call: x ~ 1 
 
                  R2.adjusted
<All variables>  0.0245062894
+ PCNM10         0.0107835463
+ PCNM3          0.0103230244
+ PCNM5          0.0092983942
+ PCNM2          0.0066557086
+ PCNM1          0.0032639188
+ PCNM8          0.0008895557
<none>           0.0000000000
+ PCNM6         -0.0006798456
+ PCNM4         -0.0007908055
+ PCNM12        -0.0034998640
+ PCNM7         -0.0040112886
+ PCNM9         -0.0099468887
+ PCNM11        -0.0106157940

         Df    AIC      F Pr(>F)  
+ PCNM10  1 195.34 1.2398  0.022 *
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step: R2.adj= 0.01078355 
Call: x ~ PCNM10 
 
                 R2.adjusted
<All variables> 0.0245062894
+ PCNM3         0.0221618992
+ PCNM5         0.0210860376
+ PCNM2         0.0183112176
+ PCNM1         0.0147498384
+ PCNM8         0.0122567570
<none>          0.0107835463
+ PCNM6         0.0106088857
+ PCNM4         0.0104923779
+ PCNM12        0.0076478663
+ PCNM7         0.0071108706
+ PCNM9         0.0008784905
+ PCNM11        0.0001761399

        Df    AIC      F Pr(>F)  
+ PCNM3  1 195.96 1.2444  0.022 *
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Step: R2.adj= 0.0221619 
Call: x ~ PCNM10 + PCNM3 
 
                R2.adjusted
+ PCNM5          0.03360549
+ PCNM2          0.03068462
+ PCNM1          0.02693580
<All variables>  0.02450629
+ PCNM8          0.02431151
+ PCNM6          0.02257691
+ PCNM4          0.02245427
<none>           0.02216190
+ PCNM12         0.01946004
+ PCNM7          0.01889479
+ PCNM9          0.01233439
+ PCNM11         0.01159507

$`Month 5`
Call: rda(formula = x ~ PCNM10 + PCNM3, data = data)

                Inertia Proportion Rank
Total         4541.9563     1.0000     
Constrained    504.4127     0.1111    2
Unconstrained 4037.5436     0.8889   20
Inertia is variance 

Eigenvalues for constrained axes:
  RDA1   RDA2 
273.58 230.83 

Eigenvalues for unconstrained axes:
  PC1   PC2   PC3   PC4   PC5   PC6   PC7   PC8 
351.8 335.3 287.4 247.3 240.3 231.8 211.6 206.0 
(Showing 8 of 20 unconstrained eigenvalues)


[1] "Summary of spatial selection process - all OTU"
$`Month 5`
                  R2.adj Df    AIC      F Pr(>F)  
+ PCNM10        0.010783  1 195.34 1.2398  0.022 *
+ PCNM3         0.022162  1 195.96 1.2444  0.022 *
<All variables> 0.024506                          
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

[1] "ANOVA on full spatial selection - all OTU"
$`Month 5`
Permutation test for rda under reduced model
Permutation: free
Number of permutations: 999

Model: rda(formula = x ~ PCNM10 + PCNM3, data = data)
         Df Variance      F Pr(>F)   
Model     2    504.4 1.2493  0.005 **
Residual 20   4037.5                 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

[1] "Partition Bray-Curtis dissimilarities - all OTUs"
Warning message:
In FUN(X[[i]], ...) :
  results may be meaningless because data have negative entries in method “bray”
Warning messages:
1: collinearity detected in X1: mm = 14, m = 13 
2: collinearity detected in cbind(X1,X2): mm = 26, m = 22 
$`Month 5`

Partition of squared Bray distance in dbRDA 

Call: varpart(Y = x, X = ~., y, data = z)

Explanatory tables:
X1:  ~.
X2:  y 

No. of explanatory tables: 2 
Total variation (SS): 3.5269 
No. of observations: 23 

Partition table:
                     Df R.squared Adj.R.squared Testable
[a+b] = X1           13    0.6551       0.15691     TRUE
[b+c] = X2           12    0.5538       0.01836     TRUE
[a+b+c] = X1+X2      22    1.0000                   TRUE
Individual fractions                                    
[a] = X1|X2          10                             TRUE
[b]                   0                            FALSE
[c] = X2|X1           9                             TRUE
[d] = Residuals                                    FALSE
---
Use function ‘dbrda’ to test significance of fractions of interest

Warning message:
collinearity detected: redundant variable(s)  between tables X1, X2
results are probably incorrect: remove redundant variable(s) and repeat the analysis 
Warning message:
In rm(abFrac, aFrac, abFrac0, pcnm_df, bcFrac, bcFrac0, step.space) :
  object 'abFrac0' not found
